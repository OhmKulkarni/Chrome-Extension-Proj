<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Header Capture Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #005a87;
        }
        .results {
            margin-top: 15px;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Header Capture Test</h1>
    <p>This page tests the Chrome extension's ability to capture request and response headers.</p>
    
    <div style="background: #f0f8ff; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
        <h3>üîß Setup Instructions:</h3>
        <ol>
            <li>Load the extension from the <strong>dist</strong> folder</li>
            <li>Open the extension dashboard</li>
            <li>Click any test button below</li>
            <li>Check the dashboard for captured requests</li>
            <li>Look for headers in the "Headers" dropdown (should show both request and response headers)</li>
        </ol>
    </div>

    <div class="test-section">
        <h3>üåê Fetch API Tests</h3>
        <p>These tests use the Fetch API with custom headers:</p>
        
        <button onclick="testFetchWithHeaders()">Fetch with Custom Headers</button>
        <button onclick="testFetchJSON()">Fetch JSON with Auth Header</button>
        <button onclick="testFetchPost()">Fetch POST with Content-Type</button>
        
        <div id="fetch-results" class="results"></div>
    </div>

    <div class="test-section">
        <h3>üì° XMLHttpRequest Tests</h3>
        <p>These tests use XMLHttpRequest with custom headers:</p>
        
        <button onclick="testXHRWithHeaders()">XHR with Custom Headers</button>
        <button onclick="testXHRJSON()">XHR JSON with Auth Header</button>
        <button onclick="testXHRPost()">XHR POST with Content-Type</button>
        
        <div id="xhr-results" class="results"></div>
    </div>

    <script>
        // Fetch API Tests
        async function testFetchWithHeaders() {
            const results = document.getElementById('fetch-results');
            results.textContent = 'Testing Fetch with custom headers...';
            
            try {
                const response = await fetch('https://httpbin.org/headers', {
                    method: 'GET',
                    headers: {
                        'X-Custom-Header': 'fetch-test-value',
                        'X-Test-ID': 'fetch-headers-001',
                        'Authorization': 'Bearer fake-token-123'
                    }
                });
                
                const data = await response.json();
                results.textContent = `‚úÖ Fetch completed\nResponse: ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                results.textContent = `‚ùå Error: ${error.message}`;
            }
        }

        async function testFetchJSON() {
            const results = document.getElementById('fetch-results');
            results.textContent = 'Testing Fetch JSON with auth header...';
            
            try {
                const response = await fetch('https://httpbin.org/json', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Authorization': 'Bearer json-fetch-token',
                        'X-Client-Version': '1.0.0'
                    }
                });
                
                const data = await response.json();
                results.textContent = `‚úÖ Fetch JSON completed\nResponse: ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                results.textContent = `‚ùå Error: ${error.message}`;
            }
        }

        async function testFetchPost() {
            const results = document.getElementById('fetch-results');
            results.textContent = 'Testing Fetch POST with content-type...';
            
            try {
                const response = await fetch('https://httpbin.org/post', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Request-ID': 'fetch-post-001',
                        'User-Agent': 'ChromeExtensionTest/1.0'
                    },
                    body: JSON.stringify({
                        test: 'fetch post data',
                        timestamp: new Date().toISOString()
                    })
                });
                
                const data = await response.json();
                results.textContent = `‚úÖ Fetch POST completed\nResponse: ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                results.textContent = `‚ùå Error: ${error.message}`;
            }
        }

        // XMLHttpRequest Tests
        function testXHRWithHeaders() {
            const results = document.getElementById('xhr-results');
            results.textContent = 'Testing XHR with custom headers...';
            
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://httpbin.org/headers');
            
            // Set custom headers
            xhr.setRequestHeader('X-Custom-Header', 'xhr-test-value');
            xhr.setRequestHeader('X-Test-ID', 'xhr-headers-001');
            xhr.setRequestHeader('Authorization', 'Bearer xhr-token-123');
            
            xhr.onload = function() {
                if (xhr.status === 200) {
                    results.textContent = `‚úÖ XHR completed\nResponse: ${xhr.responseText}`;
                } else {
                    results.textContent = `‚ùå XHR failed with status: ${xhr.status}`;
                }
            };
            
            xhr.onerror = function() {
                results.textContent = '‚ùå XHR network error';
            };
            
            xhr.send();
        }

        function testXHRJSON() {
            const results = document.getElementById('xhr-results');
            results.textContent = 'Testing XHR JSON with auth header...';
            
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://httpbin.org/json');
            
            // Set headers
            xhr.setRequestHeader('Accept', 'application/json');
            xhr.setRequestHeader('Authorization', 'Bearer json-xhr-token');
            xhr.setRequestHeader('X-Client-Version', '1.0.0');
            
            xhr.onload = function() {
                if (xhr.status === 200) {
                    results.textContent = `‚úÖ XHR JSON completed\nResponse: ${xhr.responseText}`;
                } else {
                    results.textContent = `‚ùå XHR failed with status: ${xhr.status}`;
                }
            };
            
            xhr.onerror = function() {
                results.textContent = '‚ùå XHR network error';
            };
            
            xhr.send();
        }

        function testXHRPost() {
            const results = document.getElementById('xhr-results');
            results.textContent = 'Testing XHR POST with content-type...';
            
            const xhr = new XMLHttpRequest();
            xhr.open('POST', 'https://httpbin.org/post');
            
            // Set headers
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.setRequestHeader('X-Request-ID', 'xhr-post-001');
            xhr.setRequestHeader('User-Agent', 'ChromeExtensionTest/1.0');
            
            const postData = JSON.stringify({
                test: 'xhr post data',
                timestamp: new Date().toISOString()
            });
            
            xhr.onload = function() {
                if (xhr.status === 200) {
                    results.textContent = `‚úÖ XHR POST completed\nResponse: ${xhr.responseText}`;
                } else {
                    results.textContent = `‚ùå XHR failed with status: ${xhr.status}`;
                }
            };
            
            xhr.onerror = function() {
                results.textContent = '‚ùå XHR network error';
            };
            
            xhr.send(postData);
        }
    </script>
</body>
</html>
